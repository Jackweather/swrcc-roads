<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NY Highway Cameras with Radar</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
  body, html {
    margin: 0; padding: 0; height: 100%; font-family: Arial, sans-serif;
    overflow: hidden;
  }

  /* Top header */
  #topHeader {
    position: absolute;
    top: 0; left: 0;
    width: 100%;
    height: 50px;
    background-color: rgba(70,22,107,0.9);
    color: white;
    display: flex;
    align-items: center;
    padding: 6px 12px;
    z-index: 2200;
    gap: 8px;
    box-sizing: border-box;
  }
  #topHeader button {
    padding: 6px 12px;
    border: none;
    border-radius: 6px;
    font-weight: bold;
    cursor: pointer;
  }
  #multiSelectBtn { background:#46166b; color: white; }
  #showSelectedBtn { background: #46166b; color: white; display: none; }
  #cancelMultiBtn { background: #ff4c4c; color: white; display: none; }
  #goHelloBtn { background: #46166b; color: white; }
  #toggleWinterConditionsBtn { background: #46166b; color: white; }
  #hideCamerasBtn { background: #46166b; color: white; }

  /* Map sits below the header */
  #map { 
    position: absolute;
    top: 50px; /* header height */
    left: 0;
    width: 100%; 
    height: calc(100% - 50px);
  }

  /* Fullscreen video panel */
  #videoPanel {
    position: fixed;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    background-color: #ede8f0;
    color: black;
    display: none;
    z-index: 2100;
    padding-top: 60px; /* space for header */
    box-sizing: border-box;
    overflow-y: auto; /* scrollable vertically */
  }
  #videoPanel .video-grid {
    display: grid;
    gap: 8px;
    width: 100%;
    padding: 4px;
    box-sizing: border-box;
  }
  #videoPanel video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 8px;
    background-color: black;
  }

  /* Exit fullscreen button always on top */
  #exitFullscreenBtn {
    position: fixed;
    top: 10px;
    right: 10px;
    background: #ff4c4c;
    color: white;
    padding: 6px 12px;
    border: none;
    border-radius: 6px;
    font-weight: bold;
    cursor: pointer;
    z-index: 4000;
    display: none;
  }

  /* Single camera popup */
  #singleCamPopup {
    position: fixed;
    bottom: 10px;
    right: 10px;
    width: 320px;
    height: 180px;
    background: #000;
    border-radius: 8px;
    overflow: hidden;
    display: none;
    z-index: 2000;
  }
  #singleCamPopup video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    cursor: pointer;
  }

  /* Circle markers */
  .camera-marker {
    background-color: rgba(70,22,107,0.9);
    color: white;
    font-weight: bold;
    border-radius: 50%;
    width: 28px; height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid white;
    box-shadow: 0 0 2px black;
  }
  .camera-marker.selected { background-color: darkorange; }

  /* Radar slider */
  #radarSliderContainer {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 3000;
    background: rgba(0,0,0,0.5);
    padding: 6px 12px;
    border-radius: 6px;
    color: white;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  #radarSlider {
    width: 200px;
  }
</style>
</head>
<body>

<div id="map"></div>

<!-- Top header with buttons -->
<div id="topHeader">
  <button id="multiSelectBtn">Select Multiple Cameras</button>
  <button id="showSelectedBtn">Show Selected Cameras</button>
  <button id="cancelMultiBtn">Cancel Multi-Select</button>
  <button id="goHelloBtn" onclick="window.location.href='/cams'">Auto Cams</button>
  <button id="toggleWinterConditionsBtn">Toggle Winter Conditions</button>
  <button id="hideCamerasBtn">Hide All Cameras</button>
  <span style="margin-left: auto; font-weight: bold;">SWRCC</span>
</div>

<!-- Fullscreen video panel -->
<div id="videoPanel">
  <div class="video-grid" id="videoGrid"></div>
</div>

<!-- Exit fullscreen button -->
<button id="exitFullscreenBtn">Exit Fullscreen</button>

<!-- Single camera popup -->
<div id="singleCamPopup">
  <video id="singleCamVideo" autoplay muted controls></video>
</div>

<!-- Radar slider -->
<div id="radarSliderContainer">
  <input type="range" id="radarSlider" min="0" max="8" value="0" step="1">
  <span id="radarTimeLabel">Current</span>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.0/dist/hls.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mapbox/polyline@1.1.1/src/polyline.js"></script>
<script src="/static/js/winter_conditions.js"></script>
<script src="/static/js/camera.js"></script>
<script>
  document.getElementById('hideCamerasBtn').addEventListener('click', () => {
    // Logic to hide all cameras on the map
    console.log('Hide all cameras button clicked');
  });
</script>
</body>
</html>
